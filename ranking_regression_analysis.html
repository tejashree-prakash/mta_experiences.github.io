<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Regression Analysis</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="proposal.html">Report</a>
    </li>
    <li>
      <a href="data_source.html">Data source</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="data_exploration.html">Data Exploration</a>
</li>
<li>
  <a href="borough_analysis.html">Borough Analysis</a>
</li>
<li>
  <a href="subway_line_analysis.html">Subway Line Analysis</a>
</li>
<li>
  <a href="ranking_regression_analysis.html">Regression analysis</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Regression Analysis</h1>

</div>


<p>For our regression analysis, we examined how overall rider
satisfaction varies by borough and key transit-related factors. The
model included average subway ride length, frequency of service delays,
approximate delay duration, and the frequency of rerouting events.</p>
<p>We focused on these variables because they capture the core elements
of rider experience that are most likely to influence satisfaction,
while remaining feasible to analyze within the scope of our project.
Other potentially informative variables—such as the type of complaint or
the most common reason for delays—were not included due to data
limitations, but the selected predictors still provide a meaningful view
of the factors shaping transit performance and rider perceptions.</p>
<p>All predictors and the outcome were converted to an ordinal,
categorical variable, followed by a logistic regression model befitting
an ordinal response.</p>
<pre class="r"><code>#Converting categorical variables to orders
regression_rider_data &lt;-
  rider_data_full %&gt;%
    mutate(
    average_length_subway_ride = 
      recode(
        average_length_subway_ride,
        &quot;&lt; 20 min&quot; = &quot;0&quot;, 
        &quot;20 - 40 min&quot; = &quot;1&quot;,
        &quot;40 - 60 min&quot; = &quot;2&quot;,
        &quot;60 - 90 min&quot; = &quot;3&quot;,
        &quot;90 min - 2 hours&quot; = &quot;4&quot;), 
    average_length_subway_ride = 
      factor(
        average_length_subway_ride, 
        levels = c(&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;), 
        ordered = TRUE
      )) %&gt;%
    mutate(
    frequency_of_delays = 
      recode(
        frequency_of_delays,
        &quot;Never&quot; = &quot;0&quot;, 
        &quot;Almost never&quot; = &quot;1&quot;,
        &quot;Rarely&quot; = &quot;2&quot;,
        &quot;A few times a week&quot; = &quot;3&quot;,
        &quot;Everyday&quot; = &quot;4&quot;), 
    frequency_of_delays = 
      factor(
        frequency_of_delays, 
        levels = c(&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;), 
        ordered = TRUE
      )) %&gt;%
    mutate(
    approximate_delay_duration = 
      recode(
        approximate_delay_duration,
        &quot;5 - 10 min&quot; = &quot;0&quot;, 
        &quot;10 - 20 min&quot; = &quot;1&quot;,
        &quot;20 - 45 min&quot; = &quot;2&quot;,
        &quot;45 - 60 min&quot; = &quot;3&quot;,
        &quot;&gt; 60 min&quot; = &quot;4&quot;), 
    approximate_delay_duration = 
      factor(
        approximate_delay_duration, 
        levels = c(&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;), 
        ordered = TRUE
      )) %&gt;%
    mutate(
    frequency_of_rerouting = 
      recode(
        frequency_of_rerouting,
        &quot;Almost never&quot; = &quot;0&quot;,
        &quot;Only on weekends&quot; = &quot;1&quot;, 
        &quot;Only at night&quot; = &quot;2&quot;,
        &quot;All the time&quot; = &quot;3&quot;), 
    frequency_of_rerouting = 
      factor(
        frequency_of_rerouting, 
        levels = c(&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;), 
        ordered = TRUE
      )) %&gt;%
     mutate(
      borough = case_when(
      borough == &quot;Manhattan&quot; ~ 0,
      borough %in% c(&quot;Brooklyn&quot;, &quot;Queens&quot;, &quot;Staten Island&quot;, &quot;Bronx&quot;, &quot;Long Island&quot;) ~ 1,
      borough %in% c(&quot;New Jersey&quot;, &quot;New York State&quot;, &quot;Outside NY&quot;) ~ 2,
      TRUE ~ NA_real_
    )) 

#Converting overall satisfaction to be &quot;continuous&quot; 
regression_rider_data &lt;-
  regression_rider_data %&gt;%
    mutate(
      overall_satisfaction = case_when(
      overall_satisfaction == &quot;Highly unsatisfied&quot; ~ 1,
      overall_satisfaction == &quot;Not satisfied&quot; ~ 2,
      overall_satisfaction == &quot;Neutral&quot; ~ 3,
      overall_satisfaction == &quot;Somewhat satisfied&quot; ~ 4,
      overall_satisfaction == &quot;Very satisfied&quot; ~ 5))</code></pre>
<p>Before beginning our regression analysis, we wanted to visualize the
distribution of overall satisfaction levels across our total sample.
Understanding this distribution provides a baseline for interpreting our
regression results, highlights the prevalence of positive, neutral, and
negative perceptions, and helps identify patterns or imbalances in rider
satisfaction. This step ensures that our subsequent modeling is grounded
in a clear understanding of the data, allowing us to better assess how
factors such as borough, ride length, and service reliability relate to
overall satisfaction.</p>
<pre class="r"><code>#Pick blue from gradient 
viridis_blue &lt;- viridis(100)[40]

plot_ly(regression_rider_data, 
        x = ~overall_satisfaction, 
        type = &quot;histogram&quot;,
         marker = list(color = viridis_blue)) %&gt;%
  layout(title = &quot;Distribution of Overall Satisfication Levels&quot;,
         xaxis = list(title = &quot;Satisfaction Level&quot;,
                      tickvals = 0:5,      
                      ticktext = c(&quot;Highly Unsatisfied&quot;, &quot;Not Satisfied&quot;, &quot;Neutral&quot;, &quot;Somewhat Satisfied&quot;, &quot;Very Satisfied&quot;)),
         yaxis = list(title = &quot;Count&quot;))</code></pre>
<div class="figure">
<div class="plotly html-widget html-fill-item" id="htmlwidget-878911e2ebc7db48ff09" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-878911e2ebc7db48ff09">{"x":{"visdat":{"16c5f368c024e":["function () ","plotlyVisDat"]},"cur_data":"16c5f368c024e","attrs":{"16c5f368c024e":{"x":{},"marker":{"color":"#2A768EFF"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"histogram"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Distribution of Overall Satisfication Levels","xaxis":{"domain":[0,1],"automargin":true,"title":"Satisfaction Level","tickvals":[0,1,2,3,4,5],"ticktext":["Highly Unsatisfied","Not Satisfied","Neutral","Somewhat Satisfied","Very Satisfied"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Count"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[5,4,2,2,1,3,3,2,4,2,4,3,4,3,2,2,4,5,1,2,4,1,5,3,1,3,4,4,4,2,4,3,3,1,3,2,4,2,3,2,4,4,4,2,4,2,3,5,4,1,4,4,4,4,1,4,4,5,5,1,2,1,2,1,2,2,3,3,1,4,2,2,5,2,2,1,3,4,3,2,2,3,5,2,5,4,2,4,4,2,1,4,1,1,4,4,2,2,1,4,4,3,4,2,4,3,3,2,3,2,5,3,1,1,4,1,5,3,2,5,4,3,1,3,1,4,2,4,5,5,3,3,4,5,5,3,2,2,4,2,2,4,2,3,3,3,2,4,4,2,1,3,3,3,4,4,3,4,5,4,2,2,4,4,3,2,1,3,4,3,3,4,3,2,2,1,5,5,4,2,4,1,2,2,3,2,2,3,1,3,4,3,1,1,1,4,4,1,5,1,2,2,1,3,1,1,3,2,1,2,4,4,3,3,2,3,2,5,4,4,3,5,2,3,2,3,2,4,4,2,5,5,3,3,3,3,1,4,4,2,2,1,2,2,2,2,4,1,1,4,2,2,4,2,3,2,1,4,2,2,2,5,5,2,5,4,4,5,5,4,2,2,3,2,5,5,4,2,4,2,1,3,1,5,4,1,5,2,2,5,4,2,2,3,4,5,2,2,5,4,3,3,1,1,4,2,3,3,1,2,2,4,4,4,4,3,1,1,4,4,3,2,3,3,4,2,1,1,4,3,4,4,4,3,3,3,4,3,4,4,4,3,3,3,2,4,4,4,4,3,4,4,3,3,4,4,4,4,3,3,3,4,1,4,2,2,2,3,3,3,5,2,3,4,4,2,2,5,4,2,2,4,3,4,4,1,1,4,4,3,3,3,4,2,2,2,3,3,1,3,4,3,1,1,3,2,2,2,4,4,4,5,2,4,4,3,2,1,1,1,4,3,1,1,2,1,1,4,2,2,3,1,2,2,4,4,2,4,2,2,2,2,1,2,2,2,2,3,2,1,1,1,2,2,2,1,3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,1,4,2,2,1,4,2,2,3,2,4,2,2,2,2,2,2,2,1,2,2,1,4,1,3,2,4,4,1,2,2,1,3,1,3,1,1,2,3,1,2,4,1,5,2,3,2,1,2,2,2,2,4,4,2,3,1,2,3,2,2,2,4,2,2,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,4,4,4,4,2,2,1,1,4,2,2,2,3,2,1,2,4,1,2,2,2,1,1,3,2,3,1,4,2,4,2,2,2,1,4,2,3,2,2,2,2,3,2,2,2,2,1,3,3,1,2,3,4,2,2,2,2,4,1,2,4,2,2,2,2,4,4,4,4,1,2,1,1,1,3,2,2,1,2,2,2,1,1,2,1,2,1,1,2,2,2,3,2,2,1,1,4,3,4,1,2,4,4,4,1,1,2,2,2,4,3,4,2,5,3,2,2,2,2,1,2,2,2,1,3,1,1,2,5,2,2,3,2,1,3,2,1,2,2,3,3,3,1,2,2,2,3,2,4,2,2,1,4,1,3,2,3,3,2,2,4,2,2,1,2,2,4,4,1,2,1,4,1,2,2,1,1,2,2,2,2,5,4,1,2,2,4,2,1,4,2,2,1,3,2,2,1,2,2,2,1,4,1,2,1,1,4,5,3,1,2,1,1,2,3,2,4,3,4,1,4,1,1,1,1,2,4,3,2,2,4,4,3,4,2,1,2,2,3,1,2,1,1,2,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,4,1,2,1,1,1,2,4,2,1,1,2,3,2,1,2,4,2,1,4,3,2,2,2,2,1,2,2,1,3,1,1,2,2,2,3,2,2,3,2,2,4,2,4,4,2,2,2,1,2,2,3,2,4,4,1,2,2,2,4,1,3,2,4,1,3,2,1,2,2,1,2,2,2,2,2,4,2,2,2,3,2,1,1,3,3,2,1,1,1,2,3,2,3,1,1,3,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,2,1,3,2,2,1,5,2,1,2,1,4,1,1,3,1,2,4,3,2,3,3,2,2,2,1,4,3,2,4,2,4,2,1,3,4,4,2,1,3,3,1,2,1,2,2,3,2,4,2,4,4,2,1,1,1,2,5,4,5,4,4,2,1,2,1,1,3,3,2,2,4,2,2,2,2,2,2,2,2,1,2,1,1,1,2,4,1,4,2,1,1,4,2,1,1,1,1,2,4,2,1,2,2,1,4,3,1,2,4,1,2,1,3,4,1,1,1,1,2,3,4,2,1,1,2,2,2,2,1,1,1,2,2,2,2,1,3,2,2,4,1,1,1,1,2,3,1,1,2,4,5,1,3,2,1,3,3,2,1,4,3,4,3,2,1,4,2,1,4,3,4,1,1,1,1,4,1,2,3,4,2,1,1,1,2,2,2,2,3,2,2,5,3,3,5,1,2,2,1,1,1,1,1,2,1,2,3,2,1,1,2,1,2,1,1,3,2,1,3,3,1,2,1,1,1,1,1,4,3,4,1,4,4,4,1,1,2,1,1,2,2,1,3,1,1,2,1,4,2,1,1,2,4,2,2,2,2,2,2,3,4,2,2,1,1,2,2,2,1,4,1,3,4,2,4,3,4,1,4,1,2,4,3,4,2,4,2,1,2,4,2,2,2,2,5,3,1,2,3,3,2,4,2,4,1,3,1,1,4,2,2,1,4,3,2,1,4,4,2,2,2,1,3,2,4,2,4,2,3,2,1,1,3,1,1,1,2,1,2,4,1,4,4,1,2,2,2,1,2,2,5,1,2,2,3,4,1,3,1,1,2,2,2,2,2,2,3,2,2,2,1,4,2,2,1,4,2,3,1,3,1,2,4,2,2,2,3,1,3,2,2,3,4,3,1,3,2,1,4,3,2,1,1,2,1,1,1,2,1,3,1,4,3,2,1,3,2,2,1,2,1,2,1,4,2,2,3,2,4,2,2,3,2,3,3,3,2,4,3,1,1,1,4,2,3,1,2,2,1,1,3,4,2,1,5,4,1,4,4,2,2,4,2,1,2,2,2,4,2,4,2,1,2,1,3,3,2,1,3,3,1,4,1,2,2,1,1,2,1,2,3,2,3,4,3,2,2,3,4,2,1,3,1,5,3,1,2,2,3,1,1,2,3,3,1,4,3,2,3,5,2,3,2,1,1,2,2,4,1,2,4,1,2,1,1,4,3,1,1,1,2,1,1,1,4,2,1,2,3,1,3,2,2,1,4,3,2,5,2,2,2,2,4,5,2,2,1,1,2,5,4,4,4,2,1,2,1,1,1,5,2,3,1,2,1,2,4,4,4,1,5,2,2,3,2,4,4,4,2,5,1,4,2,3,3,3,1,2,3,2,1,4,4,4,3,1,2,2,4,4,1,2,4,2,3,2,5,2,3,4,3,2,2,2,4,3,4,2,4,3,3,5,3,1,2,2,1,2,2,2,1,4,4,5,1,1,2,2,2,2,3,1,2,4,5,4,1,2,2,2,5,1,4,4,1,2,1,4,1,4,4,3,4,1,3,1,2,4,2,4,1,3,2,4,3,1,4,2,1,4,1,2,2,2,1,4,2,3,1,3,1,1,1,3,2,2,1,2,2,4,4,4,4,1,1,1,1,3,2,4,2,4,3,2,2,2,2,4,4,3,1,3,5,1,1,4,2,3,2,4,1,1,1,2,4,2,3,2,2,2,4,3,4,4,1,1,4,4,3,2,2,2,3,2,4,1,2,4,2,1,2,1,2,3,3,1,2,4,3,2,2,4,1,1,2,1,4,2,4,4,1,3,1,3,2,2,4,4,3,2,5,2,1,4,1,2,1,1,2,2,1,1,1,3,4,4,2,1,2,2,2,1,2,1,2,2,2,4,2,4,3,2,2,4,1,3,3,5,3,3,2,1,1,4,2,3,5,2,1,1,2,1,4,2,2,1,4,2,3,4,3,2,2,3,3,2,3,5,4,3,2,2,2,2,2,3,4,4,3,2,2,4,2,1,2,2,1,2,4,2,2,3,2,2,2,4,3,2,1,1,1,2,4,1,2,1,3,4,4,4,3,2,3,1,1,2,1,2,3,3,1,2,4,1,2,3,3,4,4,1,1,3,4,1,2,4,2,2,2,3,2,3,2,1,3,3,2,2,1,4,1,4,2,3,4,2,1,2,4,2,2,3,2,3,2,4,2,5,4,1,1,1,3,2,4,3,2,4,2,1,3,1,2,4,1,1,3,3,3,2,2,2,2,1,3,1,2,4,4,4,2,1,2,4,3,1,1,4,4,2,2,2,1,2,2,3,3,2,2,1,2,4,2,2,1,1,1,2,4,1,4,2,2,5,4,1,3,2,2,2,4,4,2,2,4,2,2,2,2,1,2,4,5,1,2,2,1,2,4,5,2,4,3,4,1,2,3,5,3,1,4,3,4,2,4,4,2,1,2,4,2,2,4,5,4,4,4,5,1,2,1,4,3,2,2,2,1,2,2,2,1,1,2,2,4,3,4,1,1,2,4,1,3,2,4,2,4,2,3,1,1,1,1,2,2,3,4,3,1,1,2,1,5,2,2,1,2,2,2,5,2,1,4,1,1,1,2,2,2,3,1,4,3,3,2,4,1,3,2,2,4,2,2,3,2,2,5,3,4,3,3,4,2,2,4,4,3,2,1,4,1,4,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,4,2,2,4,1,4,2,2,4,2,2,4,2,4,4,1,5,3,3,1,2,1,2,1,1,4,2,1,2,4,1,1,2,1,2,2,4,2,2,1,1,2,2,4,4,4,1,2,4,4,2,1,2,5,2,2,1,3,2,1,3,1,2,2,1,4,2,5,4,2,3,1,4,4,2,3,2,2,2,2,4,3,2,2,4,4,3,2,1,2,1,1,1,2,4,1,1,1,2,4,4,4,4,3,3,1,2,3,1,5,1,5,4,3,3,2,1,4,5,5,5,1,4,2,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,1,4,4,4,3,2,2,2,2,1,3,1,2,2,1,1,1,3,2,1,4,2,2,3,2,2,2,1,2,2,2,4,4,1,2,1,1,1,1,2,3,2,4,2,4,2,4,1,1,2,2,1,3,4,4,2,4,3,2,1,3,3,1,2,1,2,1,1,2,1,3,4,2,1,1,4,1,4,4,2,1,3,2,2,3,4,2,2,4,5,4,4,2,2,4,2,1,3,2,2,1,2,1,1,4,2,5,2,5,2,2,1,2,3,3,4,1,3,3,2,1,5,2,1,1,2,1,2,4,4,2,2,4,2,2,2,2,4,3,4,3,3,3,2,3,4,1,2,2,2,4,1,2,3,1,2,4,2,3,2,2,2,2,2,4,4,2,2,1,1,3,1,3,1,4,4,5,1,4,1,4,3,3,2,1,1,4,3,5,4,4,2,4,4,4,5,5,1,4,4,2,4,4,2,2,2,2,4,3,3,3,1,4,1,1,2,2,2,1,2,3,4,3,4,2,2,2,2,1,1,4,2,4,2,1,5,3,2,1,1,3,3,1,2,1,3,3,1,1,3,4,4,2,3,2,3,2,3,1,2,2,1,4,2,1,4,4,4,2,5,4,1,2,5,1,2,1,1,4,2,3,2,2,5,2,4,1,2,4,3,1,4,2,2,1,4,4,2,4,1,1,2,2,1,1,4,3,1,2,1,2,2,2,1,1,3,1,2,2,1,1,1,5,1,4,4,2,2,2,5,2,1,4,2,2,2,3,2,3,1,2,2,2,1,5,4,2,3,2,2,2,4,4,2,2,2,4,2,2,4,1,3,2,4,2,2,1,2,3,2,4,2,4,2,4,2,2,4,1,4,2,1,3,3,2,3,2,4,4,2,2,1,2,2,2,3,2,1,2,2,1,2,1,2,4,4,2,2,4,4,3,4,1,4,2,1,4,4,1,3,2,2,4,3,2,4,4,1,1,4,1,2,4,1,2,2,4,3,3,4,2,2,2,2,2,3,2,1,3,3,1,3,3,1,2,4,2,1,4,3,2,1,2,2,2,2,4,3,1,2,2,2,2,1,2,4,3,2,1,3,4,3,5,1,2,2,4,4,4,1,3,2,3,2,4,1,3,1,4,2,4,2,4,2,2,2,4,3,1,4,2,1,3,2,2,4,1,3,3,3,1,2,5,2,2,3,3,1,3,1,3,4,2,2,4,1,2,2,1,4,2,3,1,2,5,3,3,4,2,2,2,2,2,2,2,2,2,2,4,2,3,1,1,1,4,2,3,1,4,2,1,2,2,2,4,1,3,4,2,3,3,1,2,4,1,4,1,2,1,4,1,2,4,5,3,4,3,3,2,2,3,4,2,2,3,2,4,1,4,4,3,2,3,3,2,2,4,1,2,1,3,1,2,1,3,4,1,1,2,4,2,2,1,2,4,2,2,1,2,2,1,4,2,2,4,2,4,4,2,1,2,1,4,1,4,2,2,2,1,2,1,4,1,3,2,1,3,2,3,2,4,1,5,2,1,3,1,4,4,3,4,3,2,1,3,2,2,1,2,3,2,5,3,3,3,2,4,2,1,1,3,2,4,1,2,2,4,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,3,2,2,1,1,4,4,4,2,4,1,4,2,1,1,2,1,1,2,2,2,3,1,1,2,3,2,2,2,4,1,1,2,1,4,2,4,2,4,2,4,1,1,3,4,2,2,2,3,3,2,4,1,2,4,1,4,2,4,4,2,4,2,5,2,2,3,2,2,3,3,2,3,2,3,2,2,1,1,2,3,1,5,2,5,2,4,3,2,4,2,1,3,2,3,2,1,1,2,3,4,4,3,2,4,1,3,1,3,2,2,2,2,2,1,4,1,1,4,1,2,1,3,3,4,2,3,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,2,3,4,2,3,4,4,3,4,1,4,2,2,3,3,3,3,4,1,4,2,1,4,5,3,2,2,2,1,2,1,2,2,4,2,1,1,4,1,2,1,3,5,4,2,1,3,4,4,2,1,2,1,2,4,1,2,2,4,1,2,2,3,3,5,4,4,1,1,4,3,1,2,1,3,2,2,1,2,2,4,2,1,3,3,2,1,4,2,2,2,2,2,2,2,2,3,3,1,1,1,2,4,2,4,2,3,4,4,3,2,2,4,1,4,1,2,2,2,2,5,1,1,2,3,1,2,2,2,4,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,5,2,1,1,4,4,2,2,2,2,1,1,2,2,1,1,4,2,2,2,2,3,2,2,1,2,1,2,3,1,2,1,1,4,2,2,3,2,2,4,4,1,3,1,5,1,1,2,1,1,4,3,2,2,2,3,3,3,1,2,2,2,2,4,3,2,4,2,1,2,3,2,4,2,4,3,1,4,2,3,5,2,4,2,2,1,2,2,2,2,4,2,4,2,1,1,3,2,4,1,2,2,3,2,2,2,4,4,2,1,3,4,2,1,2,1,1,1,4,1,3,2,1,2,2,2,3,2,2,1,1,4,1,1,2,3,1,1,4,4,2,1,4,2,1,2,2,2,4,1,3,4,2,4,2,3,2,2,3,1,1,2,4,2,2,5,3,4,1,3,4,2,2,1,4,1,1,4,1,2,2,4,1,2,1,2,2,4,2,2,1,3,2,2,3,2,2,4,4,1,2,3,5,2,1,1,3,4,2,2,2,1,1,2,1,2,3,4,4,5,3,4,1,4,4,4,3,4,2,3,4,2,2,3,1,1,4,2,2,4,2,3,3,3,5,4,2,4,4,4,4,1,3,2,2,4,1,4,3,4,3,3,2,4,4,1,2,2,3,2,2,4,1,2,2,4,1,1,2,3,2,2,2,2,1,2,2,2,4,1,2,2,2,1,1,2,1,2,2,2,1,3,1,4,4,4,1,4,2,1,1,2,2,3,1,2,1,2,1,2,1,3,4,2,3,4,1,4,1,2,4,2,2,4,1,1,1,1,4,1,5,4,2,3,4,4,4,4,4,3,4,1,2,2,2,1,3,1,3,4,4,2,1,5,2,2,1,3,3,3,1,2,2,3,4,4,2,2,3,1,2,4,2,2,4,2,3,2,4,3,3,3,2,2,4,5,2,4,2,1,2,1,4,4,2,1,2,4,4,1,2,2,3,2,2,1,1,2,1,2,3,1,1,4,2,2,4,3,1,4,1,1,4,2,2,2,3,3,1,4,3,2,4,2,2,4,4,1,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,4,2,1,2,1,4,4,2,1,1,2,3,1,1,5,1,2,2,1,2,4,2,4,1,3,1,1,1,2,1,5,4,3,4,2,1,2,1,2,2,2,2,4,4,2,2,2,2,3,2,2,3,3,3,1,4,1,1,3,2,2,3,1,2,3,2,2,4,3,3,1,4,2,1,4,1,4,2,1,2,4,2,4,4,4,2,3,4,1,1,1,3,2,3,2,2,1,1,1,2,2,2,2,1,4,2,4,2,4,1,2,4,2,1,2,1,2,2,2,1,1,2,3,2,1,4,3,1,3,2,1,1,3,3,5,2,2,4,3,2,4,2,4,3,2,3,4,2,1,4,4,2,2,1,2,2,1,4,3,2,4,2,2,2,2,2,4,1,4,2,2,2,1,3,4,1,5,3,2,4,2,4,2,1,2,2,2,1,2,4,2,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,1,3,2,1,3,2,2,4,2,3,2,1,2,4,4,3,4,2,4,1,1,3,2,2,2,2,1,2,4,2,2,4,2,2,1,2,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,3,2,3,2,1,2,2,1,3,2,2,2,4,4,2,2,2,1,2,1,1,4,2,2,3,1,2,2,1,2,1,1,2,2,4,2,1,4,4,3,4,1,4,1,2,4,2,2,2,2,1,2,1,2,1,3,2,2,1,4,1,2,4,3,2,1,1,4,2,4,2,2,2,1,3,2,2,2,1,3,1,2,2,3,1,4,2,4,2,2,1,3,2,2,1,3,3,1,2,2,2,2,1,2,1,2,2,4,4,2,4,4,1,2,2,2,1,2,2,3,1,4,4,3,3,1,1,3,1,5,4,1,1,2,2,1,2,2,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,4,4,3,1,2,4,2,2,2,2,2,2,1,2,2,2,4,1,1,2,2,4,4,1,4,2,3,1,3,2,4,3,2,2,4,2,2,2,2,1,2,2,1,3,1,2,1,2,3,2,2,2,1,3,3,1,1,2,2,1,2,2,2,1,2,1,2,2,4,2,4,2,2,4,4,2,4,2,1,1,1,1,2,1,4,1,1,1,3,1,5,2,2,2,4,2,2,4,1,4,2,1,1,1,4,3,3,2,4,1,1,1,2,2,2,1,2,2,4,4,1,1,1,1,1,3,2,1,2,1,4,3,2,1,2,1,3,2,2,1,1,2,4,2,2,3,1,2,2,1,3,2,5,3,2,4,4,3,2,4,1,2,2,2,3,2,2,1,4,2,4,4,4,1,4,1,1,4,2,1,1,2,2,2,4,2,3,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,3,2,2,1,3,2,2,3,2,1,5,1,2,2,4,2,1,5,1,1,3,2,2,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,2,2,4,2,5,3,4,4,2,2,2,1,4,5,2,3,2,2,4,3,2,1,4,4,1,2,1,2,1,1,1,2,1,4,2,2,1,1,2,3,2,1,4,4,2,2,4,2,2,2,2,2,2,3,1,1,1,3,1,1,1,2,4,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,5,2,2,2,2,4,2,3,2,2,1,3,1,1,1,2,1,1,1,4,1,2,4,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,2,5,2,1,1,1,4,3,5,5,3,4,3,2,4,4,2,2,3,3,3,2,1,1,2,2,1,3,2,2,2,1,3,4,2,2,2,1,3,2,2,2,2,2,2,2,1,1,1,2,2,3,4,4,1,2,1,4,3,4,1,2,4,1,4,4,2,4,2,2,4,1,5,2,4,4,2,2,1,4,2,5,2,4,2,2,1,3,3,1,1,2,4,2,1,1,1,3,2,1,2,3,1,2,1,3,4,4,1,2,1,1,1,1,1,2,1,1,4,2,4,2,4,3,1,4,3,4,1,4,3,1,4,1,4,4,1,2,2,4,4,1,4,1,1,2,2,1,4,4,1,3,3,2,2,4,3,1,4,2,1,2,2,3,1,1,1,4,1,5,1,2,3,4,3,2,1,4,1,1,2,1,1,1,1,1,2,2,2,4,4,2,4,2,1,1,2,5,2,1,2,3,4,2,4,2,1,1,5,1,3,4,4,2,2,1,3,2,5,4,3,1,4,1,2,3,3,4,4,1,2,2,1,2,2,3,1,4,1,2,2,4,2,1,2,2,4,1,2,2,2,4,4,3,3,2,2,4,1,4,1,2,1,4,2,3,4,3,4,2,4,1,2,4,4,2,4,1,1,4,2,5,1,3,2,3,3,3,1,1,2,2,2,1,1,2,1,2,2,4,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,1,1,4,1,1,1,2,2,2,1,3,2,2,4,2,2,2,4,1,1,2,3,1,2,2,3,5,5,2,4,2,1,1,1,2,3,1,4,4,4,1,3,3,2,2,2,2,1,1,4,1,2,4,2,4,3,2,1,1,4,2,1,3,2,4,4,2,2,2,1,3,3,2,1,1,2,2,2,2,2,1,1,4,2,1,2,2,4,4,2,1,2,2,2,4,2,2,4,2,2,4,4,4,1,4,4,3,2,3,2,4,2,2,2,4,2,4,4,3,4,3,4,1,1,3,2,1,3,2,2,4,2,5,4,1,1,3,4,1,2,3,2,3,2,1,1,1,2,1,2,4,1,2,1,1,1,1,2,2,2,2,3,3,1,3,4,2,1,2,2,1,2,5,4,3,4,2,1,1,1,3,3,2,1,1,2,2,3,1,1,1,1,1,1,2,2,2,2,4,1,1,1,1,3,1,4,4,4,2,4,2,2,3,1,4,1,1,2,2,3,2,1,2,4,3,2,2,5,4,5,4,4,4,2,4,2,4,2,5,3,1,2,2,2,3,3,4,2,2,1,4,2,2,1,4,4,1,2,2,3,2,3,5,3,2,1,4,1,3,2,2,4,2,2,4,2,2,1,1,4,2,1,2,4,4,2,2,3,2,1,2,1,4,2,2,4,4,1,4,1,2,1,2,2,4,1,4,4,3,2,1,2,5,3,4,4,2,3,4,2,1,4,3,1,4,5,2,2,4,1,2,4,1,1,2,1,1,2,2,5,2,1,1,4,4,1,3,4,5,4,5,2,1,1,2,1,1,3,2,4,3,4,1,2,1,2,2,1,3,2,2,2,1,3,1,4,2,3,2,1,3,4,2,4,4,4,4,2,1,3,2,2,1,3,2,1,2,2,2,2,2,2,1,4,2,3,3,2,2,4,3,2,1,2,4,4,4,2,1,1,1,4,1,2,4],"marker":{"color":"#2A768EFF","line":{"color":"rgba(31,119,180,1)"}},"type":"histogram","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
This distribution demonstrates a slightly skewed, but close to normal
distribution of overall satisfaction responses.
</p>
</div>
<p>Running linear model</p>
<pre class="r"><code>#Run the model 
fit &lt;- lm(overall_satisfaction ~ average_length_subway_ride + frequency_of_delays + approximate_delay_duration + frequency_of_rerouting + borough, data = regression_rider_data)

#Tidying output
fit |&gt; 
  broom::tidy() |&gt; 
  select(term, estimate, p.value)</code></pre>
<pre><code>## # A tibble: 17 × 3
##    term                         estimate   p.value
##    &lt;chr&gt;                           &lt;dbl&gt;     &lt;dbl&gt;
##  1 (Intercept)                    2.95   1.30e-181
##  2 average_length_subway_ride.L  -0.182  7.26e-  3
##  3 average_length_subway_ride.Q   0.108  5.73e-  2
##  4 average_length_subway_ride.C   0.0318 4.54e-  1
##  5 average_length_subway_ride^4   0.0119 6.85e-  1
##  6 frequency_of_delays.L         -2.06   7.94e- 15
##  7 frequency_of_delays.Q         -0.154  4.91e-  1
##  8 frequency_of_delays.C          0.100  5.03e-  1
##  9 frequency_of_delays^4          0.0959 2.15e-  1
## 10 approximate_delay_duration.L  -0.449  3.72e-  5
## 11 approximate_delay_duration.Q   0.0823 3.84e-  1
## 12 approximate_delay_duration.C  -0.174  7.95e-  2
## 13 approximate_delay_duration^4  -0.142  5.02e-  2
## 14 frequency_of_rerouting.L      -0.295  7.20e- 18
## 15 frequency_of_rerouting.Q      -0.171  5.53e-  8
## 16 frequency_of_rerouting.C      -0.156  3.40e-  7
## 17 borough                        0.0632 1.49e-  2</code></pre>
<pre class="r"><code>#Visualizations
regression_rider_data |&gt; 
  modelr::add_residuals(fit) |&gt; 
  ggplot(aes(x = overall_satisfaction, y = resid)) + geom_point() +
  labs(
    title = &quot;Residual Plot for Linear Regression&quot;,
    x = &quot;Overall Satisfaction&quot;,
    y = &quot;Residuals&quot;, 
  ) +
  theme(
    plot.title = element_text(hjust = 0.5)
  )</code></pre>
<p><img src="ranking_regression_analysis_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>We should do a logistic regression model.</p>
<pre class="r"><code>#Recode overall satisfaction (outcome) to be ordered 
regression_rider_data &lt;- regression_rider_data %&gt;%
  mutate(
    overall_satisfaction = factor(
      overall_satisfaction,
      levels = c(1, 2, 3, 4, 5),
      ordered = TRUE
    )
  )

#Run logistic regression model 
model &lt;- clm(
  overall_satisfaction ~ 
    average_length_subway_ride +
    frequency_of_delays +
    approximate_delay_duration +
    frequency_of_rerouting +
    borough,
  data = regression_rider_data,
  link = &quot;logit&quot;
)

#Summary of model
model_df &lt;- broom::tidy(model, conf.int = TRUE) |&gt;
  dplyr::mutate(across(where(is.numeric), round, 3)) </code></pre>
<pre><code>## Warning: There was 1 warning in `dplyr::mutate()`.
## ℹ In argument: `across(where(is.numeric), round, 3)`.
## Caused by warning:
## ! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.
## Supply arguments directly to `.fns` through an anonymous function instead.
## 
##   # Previously
##   across(a:b, mean, na.rm = TRUE)
## 
##   # Now
##   across(a:b, \(x) mean(x, na.rm = TRUE))</code></pre>
<pre class="r"><code>#Publication style table 
tab_model(model, 
          title = &quot;Ordinal Regression Model Results&quot;)</code></pre>
<table style="border-collapse:collapse; border:none;">
<caption style="font-weight: bold; text-align:left;">
Ordinal Regression Model Results
</caption>
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
overall satisfaction
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
1|2
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.04 – 0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
2|3
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.62
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.40 – 0.94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.024</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
3|4
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.66
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.09 – 2.53
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.019</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
4|5
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
25.32
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
16.40 – 39.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
average length subway<br>ride [linear]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.66
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.50 – 0.88
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.004</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
average length subway<br>ride [quadratic]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.94 – 1.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.157
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
average length subway<br>ride [cubic]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.88 – 1.26
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.544
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
average length subway<br>ride [4th degree]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.04
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.92 – 1.18
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.497
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
frequency of delays<br>[linear]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.00 – 0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
frequency of delays<br>[quadratic]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.86
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.33 – 2.25
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.762
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
frequency of delays<br>[cubic]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.57 – 2.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.800
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
frequency of delays [4th<br>degree]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.73 – 1.42
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.909
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
approximate delay<br>duration [linear]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.36
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.24 – 0.55
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
approximate delay<br>duration [quadratic]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.15
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.80 – 1.66
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.453
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
approximate delay<br>duration [cubic]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.71
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.48 – 1.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.097
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
approximate delay<br>duration [4th degree]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.70
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.52 – 0.95
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.022</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
frequency of rerouting<br>[linear]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.53
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.46 – 0.61
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
frequency of rerouting<br>[quadratic]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.59 – 0.76
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
frequency of rerouting<br>[cubic]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.71
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.63 – 0.80
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
borough
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.14
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.03 – 1.26
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.015</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
5417
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
R<sup>2</sup> Nagelkerke
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
0.389
</td>
</tr>
</table>
<p>Visualizing effect size - if predictors increase or decrease
satisfaction odds.</p>
<pre class="r"><code>tidy_model &lt;- broom::tidy(model) %&gt;%
  filter(!grepl(&quot;\\|&quot;, term)) %&gt;%
  mutate(odds_ratio = exp(estimate),
         conf.low = exp(estimate - 1.96 * std.error),
         conf.high = exp(estimate + 1.96 * std.error))

#Remove not significant predictors 
tidy_model &lt;- tidy_model %&gt;%
  filter(term %in% c(&quot;average_length_subway_ride.L&quot;, &quot;frequency_of_delays.L&quot;, &quot;approximate_delay_duration.L&quot;, &quot;approximate_delay_duration^4&quot;, &quot;frequency_of_rerouting.L&quot;, &quot;frequency_of_rerouting.Q&quot;, &quot;frequency_of_rerouting.C&quot;, &quot;borough&quot;)) %&gt;%
  mutate(term = fct_reorder(term, odds_ratio, .desc = FALSE))  # order decreasing OR


plot_ly(tidy_model,
        x = ~odds_ratio, 
        y = ~term,
        type = &#39;scatter&#39;,
        mode = &#39;markers&#39;,
        error_x = list(type = &#39;data&#39;, symmetric = FALSE,
                       array = tidy_model$conf.high - tidy_model$odds_ratio,
                       arrayminus = tidy_model$odds_ratio - tidy_model$conf.low)) %&gt;%
  layout(title = &quot;Significant Predictor Effects on Satisfaction (ORs with 95%)&quot;,
         xaxis = list(title = &quot;Odds Ratio&quot;),
         yaxis = list(title = &quot;Predictor&quot;))</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-b0c70a73a745acdc0342" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-b0c70a73a745acdc0342">{"x":{"visdat":{"16c5f11802443":["function () ","plotlyVisDat"]},"cur_data":"16c5f11802443","attrs":{"16c5f11802443":{"x":{},"y":{},"mode":"markers","error_x":{"type":"data","symmetric":false,"array":[0.21613052486299977,0.02255526635006274,0.18579160881198925,0.24672105356905283,0.079234011911017643,0.090755316171302614,0.092422122365940607,0.12454861018491292],"arrayminus":[0.16275905375919747,0.0071897473178177433,0.12271043498209747,0.18271445572580924,0.068992923398910777,0.079911455003504717,0.081784843761247394,0.11226160641388372]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Significant Predictor Effects on Satisfaction (ORs with 95%)","xaxis":{"domain":[0,1],"automargin":true,"title":"Odds Ratio"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Predictor","type":"category","categoryorder":"array","categoryarray":["frequency_of_delays.L","approximate_delay_duration.L","frequency_of_rerouting.L","average_length_subway_ride.L","frequency_of_rerouting.Q","approximate_delay_duration^4","frequency_of_rerouting.C","borough"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0.65910118247938776,0.010553933479416924,0.36141637431831547,0.70429462802210618,0.53378955839535391,0.66880138470314077,0.7105885930679996,1.1379525323286848],"y":["average_length_subway_ride.L","frequency_of_delays.L","approximate_delay_duration.L","approximate_delay_duration^4","frequency_of_rerouting.L","frequency_of_rerouting.Q","frequency_of_rerouting.C","borough"],"mode":"markers","error_x":{"color":"rgba(31,119,180,1)","type":"data","symmetric":false,"array":[0.21613052486299977,0.02255526635006274,0.18579160881198925,0.24672105356905283,0.079234011911017643,0.090755316171302614,0.092422122365940607,0.12454861018491292],"arrayminus":[0.16275905375919747,0.0071897473178177433,0.12271043498209747,0.18271445572580924,0.068992923398910777,0.079911455003504717,0.081784843761247394,0.11226160641388372]},"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Predicted probabilities with average subway length and
satisfaction</p>
<pre class="r"><code>#Create grid of predicted probabilities 
grid &lt;- expand.grid(
  average_length_subway_ride = levels(regression_rider_data$average_length_subway_ride),
  borough = unique(regression_rider_data$borough),
  frequency_of_delays = levels(regression_rider_data$frequency_of_delays)[1],  # fix at reference level
  approximate_delay_duration = levels(regression_rider_data$approximate_delay_duration)[1],
  frequency_of_rerouting = levels(regression_rider_data$frequency_of_rerouting)[1]
)

grid$average_length_subway_ride &lt;- factor(grid$average_length_subway_ride, 
                                          ordered = TRUE,
                                          levels = levels(regression_rider_data$average_length_subway_ride))
grid$frequency_of_delays &lt;- factor(grid$frequency_of_delays, 
                                   ordered = TRUE,
                                   levels = levels(regression_rider_data$frequency_of_delays))
grid$approximate_delay_duration &lt;- factor(grid$approximate_delay_duration, 
                                         ordered = TRUE,
                                         levels = levels(regression_rider_data$approximate_delay_duration))
grid$frequency_of_rerouting &lt;- factor(grid$frequency_of_rerouting, 
                                      ordered = TRUE,
                                      levels = levels(regression_rider_data$frequency_of_rerouting))

#Get probabilities 
pred_probs &lt;- predict(model, newdata = grid, type = &quot;prob&quot;)
pred_df &lt;- cbind(grid, pred_probs)

pred_long &lt;- pred_df %&gt;%
  pivot_longer(
    cols = starts_with(&quot;fit&quot;), 
    names_to = &quot;Satisfaction&quot;, 
    values_to = &quot;Probability&quot;
  )

#Recode names
pred_long &lt;- pred_long %&gt;%
  mutate(Satisfaction = recode(
    Satisfaction,
    &quot;fit.1&quot; = &quot;Highly Unsatisfied&quot;,
    &quot;fit.2&quot; = &quot;Not satisfied&quot;,
    &quot;fit.3&quot; = &quot;Neutral&quot;,
    &quot;fit.4&quot; = &quot;Somewhat satisfied&quot;,
    &quot;fit.5&quot; = &quot;Very satisfied&quot;
  ))


#Produce plot
plot_ly(pred_long, 
    x = ~average_length_subway_ride, 
    y = ~borough, 
    z = ~Probability, 
    type = &quot;heatmap&quot;, 
    colorscale = &quot;Viridis&quot;, 
    text = ~paste(&quot;Satisfaction:&quot;, Satisfaction, &quot;&lt;br&gt;Probability:&quot;, round(Probability, 3)),
    hoverinfo = &quot;text&quot;) %&gt;%
       layout(
          title = &quot;Predicting Probability of Satisfaction by Avg Subway Ride Length&quot;,
          xaxis = list(
            title = &quot;Average Length of Subway Ride&quot;,
            tickvals = 0:5,                 
            ticktext = c(&quot;&lt; 20 min&quot;, &quot;20 - 40 min&quot;, &quot;40 - 60 min&quot;, &quot;60 - 90 min&quot;, &quot;90 min - 2 hours&quot;)  #Putting labels back 
          ),
          yaxis = list(
            title = &quot;Borough&quot;,
            tickvals = 0:5,                           # positions along y-axis
            ticktext = c(&quot;Manhattan&quot;, &quot;Other Boroughs in NYC&quot;, &quot;Outside NY&quot;)  # custom labels
          )
        )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-664a9701ba1539ad63e5" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-664a9701ba1539ad63e5">{"x":{"visdat":{"16c5f719f8d3":["function () ","plotlyVisDat"]},"cur_data":"16c5f719f8d3","attrs":{"16c5f719f8d3":{"x":{},"y":{},"z":{},"colorscale":"Viridis","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Predicting Probability of Satisfaction by Avg Subway Ride Length","xaxis":{"domain":[0,1],"automargin":true,"title":"Average Length of Subway Ride","tickvals":[0,1,2,3,4,5],"ticktext":["< 20 min","20 - 40 min","40 - 60 min","60 - 90 min","90 min - 2 hours"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Borough","tickvals":[0,1,2,3,4,5],"ticktext":["Manhattan","Other Boroughs in NYC","Outside NY"]},"scene":{"zaxis":{"title":"Probability"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"Probability","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":"Viridis","showscale":true,"x":["0","0","0","0","0","1","1","1","1","1","2","2","2","2","2","3","3","3","3","3","4","4","4","4","4","0","0","0","0","0","1","1","1","1","1","2","2","2","2","2","3","3","3","3","3","4","4","4","4","4","0","0","0","0","0","1","1","1","1","1","2","2","2","2","2","3","3","3","3","3","4","4","4","4","4"],"y":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"z":[0.0009059062177237063,0.0071469769808032791,0.013360482087914667,0.22897301072844017,0.7496136239851181,0.0011545213882179406,0.0090882712224821301,0.016894348636965161,0.27149951454937604,0.70136334420295876,0.0013581775633430889,0.01067212247442834,0.019747982235248162,0.3020019901145567,0.66621972761242376,0.0016105999721611338,0.01262729795412257,0.023234352985063982,0.33528158122787094,0.62724616786078136,0.0014815039598480048,0.011628460024932043,0.02145826162476917,0.31883821054178435,0.6465935638486664,0.00079617180085463026,0.0062873859087149032,0.011782868284959259,0.20805387282928944,0.77307970117618174,0.001014702253546169,0.0079975604018120792,0.014913789563004461,0.24836511290048438,0.7277088348811529,0.0011937239785420946,0.0093935988896441964,0.017446517530083402,0.27765186776947171,0.69431429183225868,0.0014156253965153939,0.01111786367681316,0.020546320798613404,0.30998827335547741,0.65693191677258067,0.0013021369915649571,0.010236861779889951,0.018966402813627489,0.29395905800841798,0.67553554040649955,0.0010307494596309902,0.0081228804581350081,0.015141993384908996,0.2511189721002916,0.72458540459703347,0.0013135813243703857,0.010325783818917205,0.019126238197729198,0.29562230962429414,0.67361208703468911,0.0015452520728960141,0.012121976046450421,0.02233710944839824,0.32710222423437191,0.63689343819788347,0.0018323791872554996,0.014337911869939131,0.026252054032121778,0.36100846769272726,0.59656918721795638,0.0016855366974546624,0.013206047801956687,0.024258716423733853,0.34431427940105874,0.61653541967579606],"text":["Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.007","Satisfaction: Neutral <br>Probability: 0.013","Satisfaction: Somewhat satisfied <br>Probability: 0.229","Satisfaction: Very satisfied <br>Probability: 0.75","Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.009","Satisfaction: Neutral <br>Probability: 0.017","Satisfaction: Somewhat satisfied <br>Probability: 0.271","Satisfaction: Very satisfied <br>Probability: 0.701","Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.011","Satisfaction: Neutral <br>Probability: 0.02","Satisfaction: Somewhat satisfied <br>Probability: 0.302","Satisfaction: Very satisfied <br>Probability: 0.666","Satisfaction: Highly Unsatisfied <br>Probability: 0.002","Satisfaction: Not satisfied <br>Probability: 0.013","Satisfaction: Neutral <br>Probability: 0.023","Satisfaction: Somewhat satisfied <br>Probability: 0.335","Satisfaction: Very satisfied <br>Probability: 0.627","Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.012","Satisfaction: Neutral <br>Probability: 0.021","Satisfaction: Somewhat satisfied <br>Probability: 0.319","Satisfaction: Very satisfied <br>Probability: 0.647","Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.006","Satisfaction: Neutral <br>Probability: 0.012","Satisfaction: Somewhat satisfied <br>Probability: 0.208","Satisfaction: Very satisfied <br>Probability: 0.773","Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.008","Satisfaction: Neutral <br>Probability: 0.015","Satisfaction: Somewhat satisfied <br>Probability: 0.248","Satisfaction: Very satisfied <br>Probability: 0.728","Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.009","Satisfaction: Neutral <br>Probability: 0.017","Satisfaction: Somewhat satisfied <br>Probability: 0.278","Satisfaction: Very satisfied <br>Probability: 0.694","Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.011","Satisfaction: Neutral <br>Probability: 0.021","Satisfaction: Somewhat satisfied <br>Probability: 0.31","Satisfaction: Very satisfied <br>Probability: 0.657","Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.01","Satisfaction: Neutral <br>Probability: 0.019","Satisfaction: Somewhat satisfied <br>Probability: 0.294","Satisfaction: Very satisfied <br>Probability: 0.676","Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.008","Satisfaction: Neutral <br>Probability: 0.015","Satisfaction: Somewhat satisfied <br>Probability: 0.251","Satisfaction: Very satisfied <br>Probability: 0.725","Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.01","Satisfaction: Neutral <br>Probability: 0.019","Satisfaction: Somewhat satisfied <br>Probability: 0.296","Satisfaction: Very satisfied <br>Probability: 0.674","Satisfaction: Highly Unsatisfied <br>Probability: 0.002","Satisfaction: Not satisfied <br>Probability: 0.012","Satisfaction: Neutral <br>Probability: 0.022","Satisfaction: Somewhat satisfied <br>Probability: 0.327","Satisfaction: Very satisfied <br>Probability: 0.637","Satisfaction: Highly Unsatisfied <br>Probability: 0.002","Satisfaction: Not satisfied <br>Probability: 0.014","Satisfaction: Neutral <br>Probability: 0.026","Satisfaction: Somewhat satisfied <br>Probability: 0.361","Satisfaction: Very satisfied <br>Probability: 0.597","Satisfaction: Highly Unsatisfied <br>Probability: 0.002","Satisfaction: Not satisfied <br>Probability: 0.013","Satisfaction: Neutral <br>Probability: 0.024","Satisfaction: Somewhat satisfied <br>Probability: 0.344","Satisfaction: Very satisfied <br>Probability: 0.617"],"hoverinfo":"text","type":"heatmap","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>#Create grid of predicted probabilities with frequency of delay as variable now
grid_delays &lt;- expand.grid(
  frequency_of_delays = levels(regression_rider_data$frequency_of_delays), 
  borough = unique(regression_rider_data$borough),
  average_length_subway_ride = levels(regression_rider_data$average_length_subway_ride) [1], #fix at reference level
  approximate_delay_duration = levels(regression_rider_data$approximate_delay_duration)[1],
  frequency_of_rerouting = levels(regression_rider_data$frequency_of_rerouting)[1]
)

grid_delays$average_length_subway_ride &lt;- factor(grid_delays$average_length_subway_ride, 
                                          ordered = TRUE,
                                          levels = levels(regression_rider_data$average_length_subway_ride))
grid_delays$frequency_of_delays &lt;- factor(grid_delays$frequency_of_delays, 
                                   ordered = TRUE,
                                   levels = levels(regression_rider_data$frequency_of_delays))
grid_delays$approximate_delay_duration &lt;- factor(grid_delays$approximate_delay_duration, 
                                         ordered = TRUE,
                                         levels = levels(regression_rider_data$approximate_delay_duration))
grid_delays$frequency_of_rerouting &lt;- factor(grid_delays$frequency_of_rerouting, 
                                      ordered = TRUE,
                                      levels = levels(regression_rider_data$frequency_of_rerouting))

#Get probabilities 
pred_probs &lt;- predict(model, newdata = grid_delays, type = &quot;prob&quot;)
pred_df &lt;- cbind(grid_delays, pred_probs)

pred_long &lt;- pred_df %&gt;%
  pivot_longer(
    cols = starts_with(&quot;fit&quot;), 
    names_to = &quot;Satisfaction&quot;, 
    values_to = &quot;Probability&quot;
  )

#Recode names
pred_long &lt;- pred_long %&gt;%
  mutate(Satisfaction = recode(
    Satisfaction,
    &quot;fit.1&quot; = &quot;Highly Unsatisfied&quot;,
    &quot;fit.2&quot; = &quot;Not satisfied&quot;,
    &quot;fit.3&quot; = &quot;Neutral&quot;,
    &quot;fit.4&quot; = &quot;Somewhat satisfied&quot;,
    &quot;fit.5&quot; = &quot;Very satisfied&quot;
  ))


#Produce plot
plot_ly(pred_long, 
    x = ~frequency_of_delays, 
    y = ~borough, 
    z = ~Probability, 
    type = &quot;heatmap&quot;, 
    colorscale = &quot;Viridis&quot;, 
    text = ~paste(&quot;Satisfaction:&quot;, Satisfaction, &quot;&lt;br&gt;Probability:&quot;, round(Probability, 3)),
    hoverinfo = &quot;text&quot;) %&gt;%
       layout(
          title = &quot;Predicting Probability of Satisfaction by Frequency Delays&quot;,
          xaxis = list(
            title = &quot;Frequency of Delays&quot;,
            tickvals = 0:5,                 
            ticktext = c(&quot;Never&quot;, &quot;Almost Never&quot;, &quot;Rarely&quot;, &quot;A few times a week&quot;, &quot;Everyday&quot;)  #Putting labels back 
          ),
          yaxis = list(
            title = &quot;Borough&quot;,
            tickvals = 0:5,                           # positions along y-axis
            ticktext = c(&quot;Manhattan&quot;, &quot;Other Boroughs in NYC&quot;, &quot;Outside NY&quot;)  # custom labels
          )
        )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-1183827f4f125a9ec55c" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-1183827f4f125a9ec55c">{"x":{"visdat":{"16c5f7c645a31":["function () ","plotlyVisDat"]},"cur_data":"16c5f7c645a31","attrs":{"16c5f7c645a31":{"x":{},"y":{},"z":{},"colorscale":"Viridis","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Predicting Probability of Satisfaction by Frequency Delays","xaxis":{"domain":[0,1],"automargin":true,"title":"Frequency of Delays","tickvals":[0,1,2,3,4,5],"ticktext":["Never","Almost Never","Rarely","A few times a week","Everyday"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Borough","tickvals":[0,1,2,3,4,5],"ticktext":["Manhattan","Other Boroughs in NYC","Outside NY"]},"scene":{"zaxis":{"title":"Probability"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"Probability","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":"Viridis","showscale":true,"x":["0","0","0","0","0","1","1","1","1","1","2","2","2","2","2","3","3","3","3","3","4","4","4","4","4","0","0","0","0","0","1","1","1","1","1","2","2","2","2","2","3","3","3","3","3","4","4","4","4","4","0","0","0","0","0","1","1","1","1","1","2","2","2","2","2","3","3","3","3","3","4","4","4","4","4"],"y":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"z":[0.0009059062177237063,0.0071469769808032791,0.013360482087914667,0.22897301072844017,0.7496136239851181,0.0031638141152277154,0.02446766212650564,0.043513447798761318,0.46785261525455157,0.46100246070495371,0.013078939508449664,0.092988241795394902,0.13625090548824054,0.58766804554750129,0.17001386766041354,0.059003257517190995,0.30054665654465118,0.24255117710384527,0.35640259279324077,0.041496316041071846,0.2139580143379062,0.49509690043453625,0.15882521621781384,0.12224546035634991,0.0098744086533937743,0.00079617180085463026,0.0062873859087149032,0.011782868284959259,0.20805387282928944,0.77307970117618174,0.0027813357380486077,0.021582022561885045,0.038700672627914962,0.44370480589610217,0.4932311631760492,0.01151164858903826,0.082911270390389091,0.1249639448453639,0.5915790019543512,0.18903413422085757,0.052223919886976507,0.27813795703814609,0.24040894077317693,0.38227712247425294,0.046952059827447525,0.19302686056233123,0.48866716605479488,0.17065103276086246,0.13643361797174564,0.01122132265026575,0.0010307494596309902,0.0081228804581350081,0.015141993384908996,0.2511189721002916,0.72458540459703347,0.0035986996095955836,0.027725207277284291,0.048848774985259302,0.49073079116350166,0.42909652696435913,0.014856407321800711,0.1041023771998103,0.14786810176733589,0.58062572233592524,0.15254739137512779,0.066600799192757423,0.32321476398441529,0.24280090735153959,0.33073338863557922,0.036650140835708521,0.2364937042544096,0.49848455608225894,0.14702873234199798,0.10930526084862345,0.0086877464727100426],"text":["Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.007","Satisfaction: Neutral <br>Probability: 0.013","Satisfaction: Somewhat satisfied <br>Probability: 0.229","Satisfaction: Very satisfied <br>Probability: 0.75","Satisfaction: Highly Unsatisfied <br>Probability: 0.003","Satisfaction: Not satisfied <br>Probability: 0.024","Satisfaction: Neutral <br>Probability: 0.044","Satisfaction: Somewhat satisfied <br>Probability: 0.468","Satisfaction: Very satisfied <br>Probability: 0.461","Satisfaction: Highly Unsatisfied <br>Probability: 0.013","Satisfaction: Not satisfied <br>Probability: 0.093","Satisfaction: Neutral <br>Probability: 0.136","Satisfaction: Somewhat satisfied <br>Probability: 0.588","Satisfaction: Very satisfied <br>Probability: 0.17","Satisfaction: Highly Unsatisfied <br>Probability: 0.059","Satisfaction: Not satisfied <br>Probability: 0.301","Satisfaction: Neutral <br>Probability: 0.243","Satisfaction: Somewhat satisfied <br>Probability: 0.356","Satisfaction: Very satisfied <br>Probability: 0.041","Satisfaction: Highly Unsatisfied <br>Probability: 0.214","Satisfaction: Not satisfied <br>Probability: 0.495","Satisfaction: Neutral <br>Probability: 0.159","Satisfaction: Somewhat satisfied <br>Probability: 0.122","Satisfaction: Very satisfied <br>Probability: 0.01","Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.006","Satisfaction: Neutral <br>Probability: 0.012","Satisfaction: Somewhat satisfied <br>Probability: 0.208","Satisfaction: Very satisfied <br>Probability: 0.773","Satisfaction: Highly Unsatisfied <br>Probability: 0.003","Satisfaction: Not satisfied <br>Probability: 0.022","Satisfaction: Neutral <br>Probability: 0.039","Satisfaction: Somewhat satisfied <br>Probability: 0.444","Satisfaction: Very satisfied <br>Probability: 0.493","Satisfaction: Highly Unsatisfied <br>Probability: 0.012","Satisfaction: Not satisfied <br>Probability: 0.083","Satisfaction: Neutral <br>Probability: 0.125","Satisfaction: Somewhat satisfied <br>Probability: 0.592","Satisfaction: Very satisfied <br>Probability: 0.189","Satisfaction: Highly Unsatisfied <br>Probability: 0.052","Satisfaction: Not satisfied <br>Probability: 0.278","Satisfaction: Neutral <br>Probability: 0.24","Satisfaction: Somewhat satisfied <br>Probability: 0.382","Satisfaction: Very satisfied <br>Probability: 0.047","Satisfaction: Highly Unsatisfied <br>Probability: 0.193","Satisfaction: Not satisfied <br>Probability: 0.489","Satisfaction: Neutral <br>Probability: 0.171","Satisfaction: Somewhat satisfied <br>Probability: 0.136","Satisfaction: Very satisfied <br>Probability: 0.011","Satisfaction: Highly Unsatisfied <br>Probability: 0.001","Satisfaction: Not satisfied <br>Probability: 0.008","Satisfaction: Neutral <br>Probability: 0.015","Satisfaction: Somewhat satisfied <br>Probability: 0.251","Satisfaction: Very satisfied <br>Probability: 0.725","Satisfaction: Highly Unsatisfied <br>Probability: 0.004","Satisfaction: Not satisfied <br>Probability: 0.028","Satisfaction: Neutral <br>Probability: 0.049","Satisfaction: Somewhat satisfied <br>Probability: 0.491","Satisfaction: Very satisfied <br>Probability: 0.429","Satisfaction: Highly Unsatisfied <br>Probability: 0.015","Satisfaction: Not satisfied <br>Probability: 0.104","Satisfaction: Neutral <br>Probability: 0.148","Satisfaction: Somewhat satisfied <br>Probability: 0.581","Satisfaction: Very satisfied <br>Probability: 0.153","Satisfaction: Highly Unsatisfied <br>Probability: 0.067","Satisfaction: Not satisfied <br>Probability: 0.323","Satisfaction: Neutral <br>Probability: 0.243","Satisfaction: Somewhat satisfied <br>Probability: 0.331","Satisfaction: Very satisfied <br>Probability: 0.037","Satisfaction: Highly Unsatisfied <br>Probability: 0.236","Satisfaction: Not satisfied <br>Probability: 0.498","Satisfaction: Neutral <br>Probability: 0.147","Satisfaction: Somewhat satisfied <br>Probability: 0.109","Satisfaction: Very satisfied <br>Probability: 0.009"],"hoverinfo":"text","type":"heatmap","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
