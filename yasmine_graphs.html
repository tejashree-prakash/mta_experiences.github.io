<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>yasmine_graphs</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="proposal.html">Report</a>
    </li>
    <li>
      <a href="https://data.cityofnewyork.us/City-Government/2019-Subway-Rider-Survey/4y8i-pbvd">Data source</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown-header">Data Exploration</li>
<li class="dropdown-header">Borough Analysis</li>
<li class="dropdown-header">Subway Line Analysis</li>
<li>
  <a href="borough_demographics_dashboard.html">Borough dashboard</a>
</li>
<li>
  <a href="Frequency_of_delays.html">Delay frequency</a>
</li>
<li>
  <a href="Updated-Dashboard-complaint-types-II.html">Complaint types</a>
</li>
<li>
  <a href="ranking_regression_analysis.html">Regression analysis</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">yasmine_graphs</h1>

</div>


<p>cleaned data: load packages</p>
<pre class="r"><code>library(tidyverse)
library(lubridate)</code></pre>
<p>Here I will clean the 2019_subway_rider_data</p>
<pre class="r"><code>subway_rider_data = 
  read_csv(&quot;data/2019_Subway_Rider_Survey_20251121.csv&quot;) |&gt; 
  janitor::clean_names()</code></pre>
<pre><code>## Rows: 10704 Columns: 19
## ── Column specification ──────────────
## Delimiter: &quot;,&quot;
## chr (18): subway_line_used_most_often, use_of_subway_frequency, get_to_subwa...
## lgl  (1): is_subway_affordable
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>subway_drops =
  subway_rider_data |&gt; 
  select(-survey_stop_borough, -survey_stop_location) |&gt; 
  drop_na() |&gt; 
  mutate(survey_id = row_number()) |&gt; 
  relocate(survey_id, .before = 1)</code></pre>
<p>Now I will specifically clean the data within the columns</p>
<p>Cleaned rider frequency table:</p>
<pre class="r"><code>rider_data =
  subway_drops |&gt;
  mutate(
    use_of_subway_frequency = case_when(
      use_of_subway_frequency == &quot;Everyday / Almost everyday&quot; ~ &quot;Every day&quot;,
      use_of_subway_frequency == &quot;More than once a week, varies&quot; ~ &quot;Several times a week&quot;,
      use_of_subway_frequency %in% c(&quot;Weekdays, Mon - Fri&quot;, &quot;~5 days per week&quot;) ~ &quot;5 days per week&quot;,
      use_of_subway_frequency == &quot;Once a week&quot; ~ &quot;Once a week&quot;,
      use_of_subway_frequency == &quot;Once a month&quot; ~ &quot;Once a month&quot;,
      use_of_subway_frequency == &quot;Almost never&quot; ~ &quot;Almost never&quot;,
      use_of_subway_frequency == &quot;Never&quot; ~ &quot;Never&quot;,
      TRUE ~ NA_character_
    ),
    use_of_subway_frequency = 
      factor(
        use_of_subway_frequency,
        levels = c(&quot;Never&quot;, 
                   &quot;Almost never&quot;, 
                   &quot;Once a month&quot;, 
                   &quot;Once a week&quot;,
                   &quot;Several times a week&quot;, 
                   &quot;5 days per week&quot;, 
                   &quot;Every day&quot;),
        ordered = TRUE)
    )


rider_data =
  subway_drops |&gt; 
  mutate(average_length_subway_ride = 
           factor(average_length_subway_ride,
                  levels = c(&quot;&lt; 20 min&quot;, 
                             &quot;20 - 40 min&quot;, 
                             &quot;40 - 60 min&quot;,
                             &quot;60 - 90 min&quot;, 
                             &quot;90 min - 2 hours&quot;),
                  ordered = TRUE))


rider_data =
  subway_drops |&gt;
  mutate(
    overall_satisfaction = 
      recode(
        overall_satisfaction,
        &quot;Not satisfied&quot; = &quot;Unsatisfied&quot;),
    overall_satisfaction = 
      factor(
        overall_satisfaction,
        levels = c(&quot;Highly unsatisfied&quot;,
                 &quot;Unsatisfied&quot;,
                 &quot;Neutral&quot;,
                 &quot;Somewhat satisfied&quot;,
                 &quot;Very satisfied&quot;),
      ordered = TRUE)
    )


rider_data =
  subway_drops |&gt; 
  mutate(
    frequency_of_delays = factor(
      frequency_of_delays,
      levels = c(&quot;Everyday&quot;,
                 &quot;A few times a week&quot;,
                 &quot;Rarely&quot;,
                 &quot;Almost never&quot;,
                 &quot;Never&quot;),
      ordered = TRUE)
    )</code></pre>
<p>converting complaints into long format:</p>
<pre class="r"><code>rider_data =
  rider_data |&gt; 
  mutate(
    top_three_complaints = 
      str_remove_all(top_three_complaints, &quot;\\[|\\]|&#39;&quot;)
  ) |&gt; 
  separate_rows(top_three_complaints, sep = &quot;,&quot;) |&gt; 
  mutate(top_three_complaints = 
           str_trim(top_three_complaints)) |&gt; 
  rename(complaint = top_three_complaints)</code></pre>
<p>Making some of the variables as a character and some as a factor!</p>
<pre class="r"><code>rider_data = 
  rider_data |&gt; 
  mutate(
    is_subway_affordable = if_else(
      is_subway_affordable == &quot;Yes&quot;, TRUE, FALSE),
    zip_code = as.character(zip_code)
    )


rider_data =
  rider_data |&gt; 
  mutate(
    across(c(subway_line_used_most_often,
             get_to_subway_via,
             primary_use_of_subway,
             alternative_transport), as.factor)
  )</code></pre>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD Converting zip codes into boroughs.
I used <a
href="https://www.nyc.gov/assets/planning/download/office/data-maps/nyc-population/census2000/sf1p11.xls"
class="uri">https://www.nyc.gov/assets/planning/download/office/data-maps/nyc-population/census2000/sf1p11.xls</a>
to get majority of the borough’s zip codes. Any remaining ones, I looked
up on Google. There were three zip codes that I could not find a match
for, and were likely miswritten, so I removed those data rows.</p>
<pre class="r"><code>zip_raw =
  readxl::read_excel(&quot;data/nyc_zipcodes.xls&quot;, skip = 4)</code></pre>
<pre><code>## New names:
## • `` -&gt; `...2`
## • `` -&gt; `...5`
## • `` -&gt; `...6`
## • `` -&gt; `...7`
## • `` -&gt; `...8`
## • `` -&gt; `...9`</code></pre>
<pre class="r"><code># Step 2: Rename columns properly
colnames(zip_raw) &lt;- c(
  &quot;borough&quot;, &quot;zipcode&quot;, &quot;total_population&quot;, &quot;white&quot;, &quot;black_or_african_american&quot;,
  &quot;american_indian_alaska_native&quot;, &quot;asian&quot;, &quot;native_hawaiian_other_pacific&quot;,
  &quot;some_other_race&quot;, &quot;two_or_more_races&quot;, &quot;hispanic_origin&quot;, &quot;total_housing_units&quot;
)

# Step 3: Now select only borough and zipcode
zip_code_data &lt;- zip_raw %&gt;%
  select(borough, zipcode) %&gt;%
  mutate(zipcode = as.character(zipcode))  # ensure character

# Step 4: Make rider_data zip_code a character
rider_data &lt;- rider_data %&gt;%
  mutate(zip_code = as.character(zip_code))

# Step 5: Join
rider_data_full &lt;- rider_data %&gt;%
  left_join(zip_code_data, by = c(&quot;zip_code&quot; = &quot;zipcode&quot;))</code></pre>
<pre><code>## Warning in left_join(., zip_code_data, by = c(zip_code = &quot;zipcode&quot;)): Detected an unexpected many-to-many
## relationship between `x` and `y`.
## ℹ Row 127 of `x` matches multiple
##   rows in `y`.
## ℹ Row 201 of `y` matches multiple
##   rows in `x`.
## ℹ If a many-to-many relationship is
##   expected, set `relationship =
##   &quot;many-to-many&quot;` to silence this
##   warning.</code></pre>
<pre class="r"><code># Step 6: Fill borough where missing
rider_data_full &lt;- rider_data_full %&gt;%
  mutate(borough = coalesce(borough, as.character(zip_code)))

# Step 7: Remove invalid zip codes
rider_data_full &lt;- rider_data_full %&gt;%
  filter(!zip_code %in% c(&quot;12105&quot;, &quot;11290&quot;, &quot;11135&quot;))</code></pre>
<p>I think that maybe top 3 complaints shouldn’t be separated into
individual rows because now it’s double or triple counting all of the
other responses in other columns.</p>
<p>should approximate delay duration be an ordered factor?</p>
<div id="final-data-set-is-rider_data_full" class="section level1">
<h1>final data set is rider_data_full</h1>
<p>should approximate delay duration be an ordered factor?</p>
<p>anyways final data set is rider_data</p>
<div id="create-graphs" class="section level2">
<h2>Create Graphs</h2>
<pre class="r"><code>library(dplyr)
library(ggplot2)
library(plotly)</code></pre>
<p>How do riders feel about their delays?</p>
<pre class="r"><code>delay_reason =
  rider_data |&gt;
  filter(
    !is.na(most_common_reason_for_delay),
    !is.na(overall_satisfaction)
  ) |&gt;
  count(most_common_reason_for_delay, overall_satisfaction)</code></pre>
<pre class="r"><code>delay_reason_plot =
  plot_ly(
    delay_reason,
    x = ~most_common_reason_for_delay,
    y = ~n,
    color = ~overall_satisfaction,
    type = &quot;bar&quot;,
    colors = &quot;viridis&quot;,
    text = ~paste(
      &quot;Delay reason:&quot;, most_common_reason_for_delay,
      &quot;&lt;br&gt;Satisfaction:&quot;, overall_satisfaction,
      &quot;&lt;br&gt;Riders:&quot;, n
    ),
    hoverinfo = &quot;text&quot;
  ) |&gt;
  layout(
    barmode = &quot;stack&quot;,
    title = &quot;Delay Reason by Overall Satisfaction&quot;,
    xaxis = list(title = &quot;Most Common Reason to Delay&quot;),
    yaxis = list(title = &quot;Number of Riders&quot;)
  )

delay_reason_plot</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-7f6ff9b94d4af050b085" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-7f6ff9b94d4af050b085">{"x":{"visdat":{"4ac825db75e7":["function () ","plotlyVisDat"]},"cur_data":"4ac825db75e7","attrs":{"4ac825db75e7":{"x":{},"y":{},"text":{},"hoverinfo":"text","color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"barmode":"stack","title":"Delay Reason by Overall Satisfaction","xaxis":{"domain":[0,1],"automargin":true,"title":"Most Common Reason to Delay","type":"category","categoryorder":"array","categoryarray":["No reason is given","Police incident","Sick passenger","Signal malfunction","Train traffic","Waiting for signal change","Weather"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of Riders"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["No reason is given","Police incident","Sick passenger","Signal malfunction","Train traffic","Waiting for signal change","Weather"],"y":[613,35,140,827,1707,318,2],"text":["Delay reason: No reason is given <br>Satisfaction: Highly unsatisfied <br>Riders: 613","Delay reason: Police incident <br>Satisfaction: Highly unsatisfied <br>Riders: 35","Delay reason: Sick passenger <br>Satisfaction: Highly unsatisfied <br>Riders: 140","Delay reason: Signal malfunction <br>Satisfaction: Highly unsatisfied <br>Riders: 827","Delay reason: Train traffic <br>Satisfaction: Highly unsatisfied <br>Riders: 1707","Delay reason: Waiting for signal change <br>Satisfaction: Highly unsatisfied <br>Riders: 318","Delay reason: Weather <br>Satisfaction: Highly unsatisfied <br>Riders: 2"],"hoverinfo":["text","text","text","text","text","text","text"],"type":"bar","name":"Highly unsatisfied","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["No reason is given","Police incident","Sick passenger","Signal malfunction","Train traffic","Waiting for signal change","Weather"],"y":[199,47,103,355,1243,215,6],"text":["Delay reason: No reason is given <br>Satisfaction: Neutral <br>Riders: 199","Delay reason: Police incident <br>Satisfaction: Neutral <br>Riders: 47","Delay reason: Sick passenger <br>Satisfaction: Neutral <br>Riders: 103","Delay reason: Signal malfunction <br>Satisfaction: Neutral <br>Riders: 355","Delay reason: Train traffic <br>Satisfaction: Neutral <br>Riders: 1243","Delay reason: Waiting for signal change <br>Satisfaction: Neutral <br>Riders: 215","Delay reason: Weather <br>Satisfaction: Neutral <br>Riders: 6"],"hoverinfo":["text","text","text","text","text","text","text"],"type":"bar","name":"Neutral","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["No reason is given","Police incident","Sick passenger","Signal malfunction","Train traffic","Waiting for signal change","Weather"],"y":[590,64,191,1164,2806,605,5],"text":["Delay reason: No reason is given <br>Satisfaction: Not satisfied <br>Riders: 590","Delay reason: Police incident <br>Satisfaction: Not satisfied <br>Riders: 64","Delay reason: Sick passenger <br>Satisfaction: Not satisfied <br>Riders: 191","Delay reason: Signal malfunction <br>Satisfaction: Not satisfied <br>Riders: 1164","Delay reason: Train traffic <br>Satisfaction: Not satisfied <br>Riders: 2806","Delay reason: Waiting for signal change <br>Satisfaction: Not satisfied <br>Riders: 605","Delay reason: Weather <br>Satisfaction: Not satisfied <br>Riders: 5"],"hoverinfo":["text","text","text","text","text","text","text"],"type":"bar","name":"Not satisfied","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["No reason is given","Police incident","Sick passenger","Signal malfunction","Train traffic","Waiting for signal change","Weather"],"y":[237,109,134,449,1609,350,13],"text":["Delay reason: No reason is given <br>Satisfaction: Somewhat satisfied <br>Riders: 237","Delay reason: Police incident <br>Satisfaction: Somewhat satisfied <br>Riders: 109","Delay reason: Sick passenger <br>Satisfaction: Somewhat satisfied <br>Riders: 134","Delay reason: Signal malfunction <br>Satisfaction: Somewhat satisfied <br>Riders: 449","Delay reason: Train traffic <br>Satisfaction: Somewhat satisfied <br>Riders: 1609","Delay reason: Waiting for signal change <br>Satisfaction: Somewhat satisfied <br>Riders: 350","Delay reason: Weather <br>Satisfaction: Somewhat satisfied <br>Riders: 13"],"hoverinfo":["text","text","text","text","text","text","text"],"type":"bar","name":"Somewhat satisfied","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["No reason is given","Police incident","Sick passenger","Signal malfunction","Train traffic","Waiting for signal change","Weather"],"y":[40,9,27,39,234,66,3],"text":["Delay reason: No reason is given <br>Satisfaction: Very satisfied <br>Riders: 40","Delay reason: Police incident <br>Satisfaction: Very satisfied <br>Riders: 9","Delay reason: Sick passenger <br>Satisfaction: Very satisfied <br>Riders: 27","Delay reason: Signal malfunction <br>Satisfaction: Very satisfied <br>Riders: 39","Delay reason: Train traffic <br>Satisfaction: Very satisfied <br>Riders: 234","Delay reason: Waiting for signal change <br>Satisfaction: Very satisfied <br>Riders: 66","Delay reason: Weather <br>Satisfaction: Very satisfied <br>Riders: 3"],"hoverinfo":["text","text","text","text","text","text","text"],"type":"bar","name":"Very satisfied","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>which trains are the worst with delays?</p>
<pre class="r"><code>delay_counts =
  rider_data |&gt;
  filter(frequency_of_delays %in% c(&quot;Everyday&quot;, &quot;A few times a week&quot;)) |&gt;
  count(subway_line_used_most_often, sort = TRUE)</code></pre>
<pre class="r"><code>delay_counts_plot =
  plot_ly(
  delay_counts,
  labels = ~subway_line_used_most_often,
  values = ~n,
  type = &quot;pie&quot;
) |&gt;
  layout(
    title = &quot;Subway Lines with the Most Delays&quot;
  )

delay_counts_plot</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-9a917c0e367c73de492c" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-9a917c0e367c73de492c">{"x":{"visdat":{"4ac8180e2244":["function () ","plotlyVisDat"]},"cur_data":"4ac8180e2244","attrs":{"4ac8180e2244":{"labels":{},"values":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Subway Lines with the Most Delays","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["1","R","A","F","7","2","Q","N","E","6","C","D","4","L","3","B","5","M","G","J","W","Staten Island Railway","S","Z"],"values":[2452,1178,1160,957,683,639,589,566,535,464,412,405,403,403,223,195,194,194,191,184,63,17,5,3],"type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
